# ChoiceGame Smart Contract

The `ChoiceGame` smart contract is a decentralized game built on the Ethereum blockchain. It uses Chainlink VRF for generating random numbers and allows users to play a token-based game by staking `Choice` tokens. Depending on the randomness, players may receive rewards in `Choice` tokens.

## Features

- **Random Number Generation**: Powered by Chainlink VRF for fair and verifiable randomness.
- **Token-based Game**: Players stake `Choice` tokens and potentially win more tokens based on randomness.
- **Owner Controls**: The contract owner can manage token reserves, withdraw funds, and add tokens to the contract.
- **Ethereum Integration**: Accepts ETH for gas payments during gameplay.

---

## Prerequisites

- **Ethereum Wallet**: Players must have an Ethereum wallet with sufficient ETH for gas fees and `Choice` tokens for gameplay.
- **Chainlink Integration**: Requires LINK tokens to interact with Chainlink VRF.

---

## Contract Details

### Constructor

The contract is initialized with:

- `_choiceToken`: Address of the ERC20 token used for the game.
- `_vrfCoordinator`: Address of the Chainlink VRF Coordinator.
- `_linkToken`: Address of the LINK token.
- `_keyHash`: Key hash used by Chainlink VRF.
- `_fee`: LINK token fee for random number requests.

### Public Variables

- `choiceToken`: ERC20 token used in the game.
- `keyHash`: Chainlink VRF key hash.
- `fee`: LINK token fee for random number requests.
- `randomness`: The latest random number generated by Chainlink VRF.
- `owner`: The contract owner.

---

## Functions

### `playGame(uint256 X)`

- **Description**: Allows a user to play the game by staking `X` `Choice` tokens and paying a minimum of 0.001 ETH for gas.
- **Steps**:
  1. Verifies the user has enough `Choice` tokens.
  2. Transfers `X` tokens to the contract.
  3. Requests a random number from Chainlink VRF.
  4. Emits `RequestedRandomness` and `ReceivedChoice` events.

### `fulfillRandomness(bytes32 requestId, uint256 randomNum)`

- **Description**: Chainlink VRF callback function to handle random number results.
- **Logic**:
  - Calculates a multiplier `Y` (random value between 1 and 10).
  - Calculates the reward amount `Z` as `Y * 1e18` tokens.
  - Transfers `Z` tokens to the player if the contract has enough balance.
  - Emits the `SentChoice` event.

### Owner-Only Functions

- `addChoiceTokens(uint256 amount)`: Transfers `amount` `Choice` tokens from the owner to the contract.
- `withdrawETH()`: Transfers all ETH in the contract to the owner.
- `withdrawChoiceTokens(uint256 amount)`: Transfers `amount` `Choice` tokens to the owner.

### Fallback Functions

- `receive()`: Accepts ETH sent directly to the contract.

---

## Events

- `RequestedRandomness(bytes32 requestId)`: Emitted when a random number is requested.
- `ReceivedChoice(uint256 amount)`: Emitted when tokens are staked by a user.
- `SentChoice(address recipient, uint256 amount)`: Emitted when tokens are sent as rewards.

---

## Deployment Instructions

1. Deploy the contract with the following parameters:
   - `_choiceToken`: Address of the `Choice` token.
   - `_vrfCoordinator`: Address of the Chainlink VRF Coordinator.
   - `_linkToken`: Address of the LINK token.
   - `_keyHash`: Chainlink VRF key hash.
   - `_fee`: LINK token fee.
2. Fund the contract with LINK tokens to pay for VRF requests.
3. Add `Choice` tokens to the contract using the `addChoiceTokens` function.

---

## Usage

1. **Play the Game**:
   - Call `playGame(X)` with the amount of `Choice` tokens you want to stake.
   - Ensure you have enough ETH for gas and tokens for staking.
2. **Rewards**:
   - Based on the randomness, receive rewards in `Choice` tokens.

---

## Security Notes

- The contract owner has privileges to withdraw funds and manage token reserves.
- Ensure the contract is funded with enough `Choice` tokens and LINK tokens for seamless gameplay.

---

## License

This project is licensed under the [MIT License](https://opensource.org/licenses/MIT).
